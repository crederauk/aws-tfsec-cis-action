{
    "checks": [
      {
        "code": "cus-azure-resource-tags",
        "description": "Custom check to ensure Azure resources have tags for cost monitoring purposes",
        "resolution": "Add tags 'CreatedBy', 'Environment' and 'Project'",
        "requiredTypes": [
          "resource"
        ],
        "requiredLabels": [
          "virtual_desktop_application_group",
          "virtual_desktop_host_pool",
          "azurerm_eventgrid_system_topic",
          "azurerm_user_assigned_identity",
          "azurerm_monitor_metric_alert",
          "azurerm_security_center_automation",
          "azurerm_machine_learning_inference_cluster",
          "azurerm_shared_image_version",
          "azurerm_bastion_host",
          "azurerm_service_fabric_mesh_secret",
          "azurerm_shared_image_gallery",
          "azurerm_network_watcher",
          "azurerm_stream_analytics_cluster",
          "azurerm_postgresql_flexible_server",
          "azurerm_dns_srv_record",
          "azurerm_vpn_gateway",
          "azurerm_key_vault",
          "azurerm_private_dns_a_record",
          "azurerm_communication_service",
          "azurerm_netapp_volume",
          "azurerm_app_configuration_feature",
          "azurerm_application_security_group",
          "azurerm_hdinsight_kafka_cluster",
          "azurerm_dev_test_global_vm_shutdown_schedule",
          "azurerm_network_connection_monitor",
          "azurerm_ssh_public_key",
          "azurerm_managed_application",
          "azurerm_function_app_slot",
          "azurerm_frontdoor_firewall_policy",
          "azurerm_time_series_insights_standard_environment",
          "azurerm_search_service",
          "azurerm_log_analytics_storage_insights",
          "azurerm_dns_ptr_record",
          "azurerm_api_management_named_value",
          "azurerm_kusto_cluster",
          "azurerm_maps_creator",
          "azurerm_mysql_flexible_server",
          "azurerm_app_service_certificate_order",
          "azurerm_firewall_policy",
          "azurerm_data_protection_backup_vault",
          "azurerm_managed_disk",
          "azurerm_dev_test_schedule",
          "azurerm_linux_web_app",
          "azurerm_function_app",
          "azurerm_network_security_group",
          "azurerm_management_group_template_deployment",
          "azurerm_time_series_insights_event_source_iothub",
          "azurerm_monitor_smart_detector_alert_rule",
          "azurerm_dedicated_hardware_security_module",
          "azurerm_machine_learning_compute_cluster",
          "azurerm_public_ip_prefix",
          "azurerm_aadb2c_directory",
          "azurerm_automation_dsc_configuration",
          "azurerm_dns_a_record",
          "azurerm_healthcare_service",
          "azurerm_resource_group",
          "azurerm_service_fabric_managed_cluster",
          "azurerm_maintenance_configuration",
          "azurerm_proximity_placement_group",
          "azurerm_dev_test_lab",
          "azurerm_monitor_action_rule_suppression",
          "azurerm_mssql_elasticpool",
          "azurerm_service_plan",
          "azurerm_machine_learning_compute_instance",
          "azurerm_hdinsight_spark_cluster",
          "azurerm_automation_runbook",
          "azurerm_storage_disks_pool",
          "azurerm_logz_monitor",
          "azurerm_bot_web_app",
          "azurerm_key_vault_certificate",
          "azurerm_stream_analytics_job",
          "azurerm_recovery_services_vault",
          "azurerm_container_registry_task",
          "azurerm_iot_security_solution",
          "azurerm_logic_app_workflow",
          "azurerm_cosmosdb_account",
          "azurerm_backup_protected_vm",
          "azurerm_log_analytics_linked_service",
          "azurerm_logic_app_integration_account",
          "azurerm_storage_account",
          "azurerm_key_vault_managed_hardware_security_module",
          "azurerm_application_insights",
          "azurerm_custom_provider",
          "azurerm_spring_cloud_service",
          "azurerm_powerbi_embedded",
          "azurerm_video_analyzer",
          "azurerm_route_table",
          "azurerm_key_vault_secret",
          "azurerm_postgresql_server",
          "azurerm_dedicated_host_group",
          "azurerm_notification_hub_namespace",
          "azurerm_log_analytics_cluster",
          "azurerm_service_fabric_mesh_application",
          "azurerm_eventhub_cluster",
          "azurerm_signalr_service",
          "azurerm_dns_cname_record",
          "azurerm_traffic_manager_profile",
          "azurerm_eventhub_namespace",
          "azurerm_application_insights_web_test",
          "azurerm_public_ip",
          "azurerm_log_analytics_saved_search",
          "azurerm_virtual_machine",
          "azurerm_web_application_firewall_policy",
          "azurerm_app_configuration",
          "azurerm_private_dns_ptr_record",
          "azurerm_network_interface",
          "azurerm_dev_test_policy",
          "azurerm_log_analytics_solution",
          "azurerm_virtual_hub",
          "azurerm_dns_caa_record",
          "azurerm_service_fabric_cluster",
          "azurerm_network_profile",
          "azurerm_healthbot",
          "azurerm_subnet_service_endpoint_storage_policy",
          "azurerm_key_vault_managed_storage_account_sas_token_definition",
          "azurerm_cdn_profile",
          "azurerm_disk_access",
          "azurerm_data_factory",
          "azurerm_dns_ns_record",
          "azurerm_key_vault_key",
          "azurerm_databricks_workspace",
          "azurerm_private_dns_srv_record",
          "azurerm_network_ddos_protection_plan",
          "azurerm_machine_learning_synapse_spark",
          "azurerm_api_management_property",
          "azurerm_availability_set",
          "azurerm_kubernetes_cluster_node_pool",
          "azurerm_mssql_server",
          "azurerm_frontdoor",
          "azurerm_container_group",
          "azurerm_iot_time_series_insights_reference_data_set",
          "azurerm_network_watcher_flow_log",
          "azurerm_machine_learning_workspace",
          "azurerm_data_lake_analytics_account",
          "azurerm_redis_cache",
          "azurerm_local_network_gateway",
          "azurerm_hdinsight_rserver_cluster",
          "azurerm_cdn_endpoint",
          "azurerm_express_route_gateway",
          "azurerm_synapse_sql_pool",
          "azurerm_stack_hci_cluster",
          "azurerm_dashboard",
          "azurerm_private_dns_zone_virtual_network_link",
          "azurerm_static_site",
          "azurerm_dedicated_host",
          "azurerm_lb",
          "azurerm_disk_pool",
          "azurerm_synapse_spark_pool",
          "azurerm_dns_txt_record",
          "azurerm_kubernetes_cluster",
          "azurerm_managed_application_definition",
          "azurerm_netapp_account",
          "azurerm_backup_policy_vm",
          "azurerm_shared_image",
          "azurerm_redis_enterprise_cluster",
          "azurerm_dns_mx_record",
          "azurerm_monitor_action_rule_action_group",
          "azurerm_iothub_dps",
          "azurerm_app_configuration_key",
          "azurerm_disk_encryption_set",
          "azurerm_private_endpoint",
          "azurerm_point_to_site_vpn_gateway",
          "azurerm_image",
          "azurerm_private_dns_cname_record",
          "azurerm_virtual_machine_extension",
          "azurerm_eventgrid_topic",
          "azurerm_dev_test_linux_virtual_machine",
          "azurerm_vpn_site",
          "azurerm_sql_managed_instance",
          "azurerm_devspace_controller",
          "azurerm_monitor_action_group",
          "azurerm_subscription_template_deployment",
          "azurerm_sql_failover_group",
          "azurerm_integration_service_environment",
          "azurerm_service_fabric_mesh_local_network",
          "azurerm_private_dns_zone",
          "azurerm_virtual_machine_scale_set",
          "azurerm_media_live_event",
          "azurerm_service_fabric_mesh_secret_value",
          "azurerm_ip_group",
          "azurerm_linux_virtual_machine_scale_set",
          "azurerm_log_analytics_workspace",
          "azurerm_attestation",
          "azurerm_virtual_hub_security_partner_provider",
          "azurerm_mariadb_server",
          "azurerm_logic_app_standard",
          "azurerm_databox_edge_device",
          "azurerm_purview_account",
          "azurerm_app_service_slot",
          "azurerm_api_management",
          "azurerm_express_route_circuit",
          "azurerm_subscription",
          "azurerm_relay_namespace",
          "azurerm_data_lake_store",
          "azurerm__digital_twins_instance",
          "azurerm_windows_virtual_machine",
          "azurerm_nat_gateway",
          "azurerm_synapse_workspace",
          "azurerm_application_gateway",
          "azurerm_spatial_anchors_account",
          "azurerm_spatial_anchors_account",
          "azurerm_private_link_service",
          "azurerm_dns_zone",
          "azurerm_app_service",
          "azurerm_sql_database",
          "azurerm_app_service_managed_certificate",
          "azurerm_mssql_server",
          "azurerm_dev_test_windows_virtual_machine",
          "azurerm_orchestrated_virtual_machine_scale_set",
          "azurerm_time_series_insights_event_source_eventhub",
          "azurerm_express_route_port",
          "azurerm_active_directory_domain_service",
          "azurerm_windows_function_app",
          "azurerm_media_streaming_endpoint",
          "azurerm_dev_test_virtual_network",
          "azurerm_dev_test_virtual_network",
          "azurerm_hdinsight_hbase_cluster",
          "azurerm_route_filter",
          "azurerm_virtual_desktop_scaling_plan",
          "azurerm_hdinsight_ml_services_cluster",
          "azurerm_tenant_template_deployment",
          "azurerm_monitor_autoscale_setting",
          "azurerm_load_test",
          "azurerm_hdinsight_hadoop_cluster",
          "azurerm_hpc_cache",
          "azurerm_batch_account",
          "azurerm_eventgrid_domain",
          "azurerm_virtual_wan",
          "azurerm_app_service_environment_v3",
          "azurerm_linux_function_app",
          "azurerm_windows_virtual_machine_scale_set",
          "azurerm_snapshot",
          "azurerm_mssql_virtual_machine",
          "azurerm_virtual_network_gateway",
          "azurerm_app_service_plan",
          "azurerm_iothub",
          "azurerm_bot_service_azure_bot",
          "azurerm_notification_hub",
          "azurerm_monitor_activity_log_alert",
          "azurerm_data_share_account",
          "azurerm_storage_sync",
          "azurerm_vpn_server_configuration",
          "azurerm_database_migration_service",
          "azurerm_maps_account",
          "azurerm_linux_web_app_slot",
          "azurerm_sql_elasticpool",
          "azurerm_iotcentral_application",
          "azurerm_firewall",
          "azurerm_virtual_network",
          "azurerm_synapse_private_link_hub",
          "azurerm_cognitive_account",
          "azurerm_dns_aaaa_record",
          "azurerm_mysql_server",
          "azurerm_app_service_environment",
          "azurerm_resource_group_template_deployment",
          "azurerm_automation_account",
          "azurerm_database_migration_project",
          "azurerm_mssql_job_agent",
          "azurerm_monitor_private_link_scope",
          "azurerm_private_dns_txtrecord",
          "azurerm_private_dns_aaaa_record",
          "azurerm_linux_virtual_machine",
          "azurerm_vmware_private_cloud",
          "azurerm_servicebus_namespace",
          "azurerm_container_registry",
          "azurerm_media_services_account",
          "azurerm_sql_server",
          "azurerm_netapp_pool",
          "azurerm_private_dns_mx_record",
          "azurerm_virtual_network_gateway_connection",
          "azurerm_key_vault_managed_storage_account",
          "azurerm_hdinsight_storm_cluster",
          "azurerm_windows_web_app",
          "azurerm_bot_connection",
          "azurerm_virtual_desktop_workspace",
          "azurerm_hdinsight_interactive_query_cluster",
          "azurerm_time_series_insights_gen2_environment",
          "azurerm_bot_channels_registration",
          "azurerm_mssql_database"
        ],
        "severity": "Medium",
        "matchSpec": {
          "action": "and",
          "predicateMatchSpec": [
            {
              "name": "tags",
              "action": "contains",
              "value": "CreatedBy"
            },
            {
              "name": "tags",
              "action": "contains",
              "value": "Environment"
            },
            {
              "name": "tags",
              "action": "contains",
              "value": "Project"
            }
          ]
        },
        "errorMessage": "Following tags are required: 'CreatedBy', 'Environment', 'Project'",
        "relatedLinks": []
      }
    ]   
  }
  