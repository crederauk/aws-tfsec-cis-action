{
    "checks": [
      {
        "code": "cus-aws-resource-tags",
        "description": "Custom check to ensure AWS resources have tags for cost monitoring purposes",
        "resolution": "Add tags 'CreatedBy', 'Environment' and 'Project'",
        "requiredTypes": [
          "resource"
        ],
        "requiredLabels": [
          "aws_ssm_maintenance_window",
          "aws_ec2_host",
          "aws_codedeploy_app",
          "aws_inspector_resource_group",
          "aws_datapipeline_pipeline",
          "aws_amplify_app",
          "aws_glue_dev_endpoint",
          "aws_network_interface",
          "aws_networkfirewall_firewall_policy",
          "aws_storagegateway_cached_iscsi_volume",
          "aws_s3_bucket_analytics_configuration",
          "aws_wafv2_regex_pattern_set",
          "aws_api_gateway_api_key",
          "aws_ec2_transit_gateway_route_table",
          "aws_service_discovery_http_namespace",
          "aws_batch_scheduling_policy",
          "aws_sagemaker_workteam",
          "aws_config_aggregate_authorization",
          "aws_vpn_gateway",
          "aws_fsx_ontap_file_system",
          "aws_iam_policy",
          "aws_storagegateway_tape_pool",
          "aws_elastic_beanstalk_application",
          "aws_dms_certificate",
          "aws_storagegateway_stored_iscsi_volume",
          "aws_default_subnet",
          "aws_glue_registry",
          "aws_datasync_location_nfs",
          "aws_codepipeline_webhook",
          "aws_elasticsearch_domain",
          "aws_elb",
          "aws_datasync_location_s3",
          "aws_redshift_subnet_group",
          "aws_wafv2_rule_group",
          "aws_iam_service_linked_role",
          "aws_appmesh_route",
          "aws_elasticache_user",
          "aws_sagemaker_device_fleet",
          "aws_vpc_ipam_pool",
          "aws_shield_protection",
          "aws_sagemaker_endpoint",
          "aws_service_discovery_service",
          "aws_ssm_patch_baseline",
          "aws_redshift_snapshot_copy_grant",
          "aws_organizations_account",
          "aws_cloudfront_distribution",
          "aws_kinesis_analytics_application",
          "aws_dx_hosted_public_virtual_interface_accepter",
          "aws_default_network_acl",
          "aws_transfer_user",
          "aws_memorydb_cluster",
          "aws_db_security_group",
          "aws_guardduty_threatintelset",
          "aws_docdb_cluster",
          "aws_redshift_cluster",
          "aws_rds_cluster",
          "aws_ami_from_instance",
          "aws_iam_user",
          "aws_service_discovery_public_dns_namespace",
          "aws_cloudwatch_composite_alarm",
          "aws_ami",
          "aws_db_option_group",
          "aws_amplify_branch",
          "aws_api_gateway_domain_name",
          "aws_default_route_table",
          "aws_waf_rule",
          "aws_elasticache_parameter_group",
          "aws_elasticache_subnet_group",
          "aws_codepipeline",
          "aws_imagebuilder_infrastructure_configuration",
          "aws_opsworks_custom_layer",
          "aws_vpc_ipam",
          "aws_dx_public_virtual_interface",
          "aws_s3_bucket_metric",
          "aws_wafregional_web_acl",
          "aws_apigatewayv2_stage",
          "aws_gamelift_alias",
          "aws_s3control_bucket",
          "aws_vpn_connection",
          "aws_neptune_cluster_endpoint",
          "aws_fsx_ontap_volume",
          "aws_kinesis_firehose_delivery_stream",
          "aws_appsync_graphql_api",
          "aws_kms_key",
          "aws_datasync_location_fsx_windows_file_system",
          "aws_batch_job_queue",
          "aws_sagemaker_studio_lifecycle_config",
          "aws_sagemaker_model",
          "aws_imagebuilder_image_recipe",
          "aws_service_discovery_private_dns_namespace",
          "aws_datasync_location_hdfs",
          "aws_appconfig_environment",
          "aws_sfn_state_machine",
          "aws_connect_contact_flow_module",
          "aws_timestreamwrite_table",
          "aws_gamelift_game_session_queue",
          "aws_apigatewayv2_domain_name",
          "aws_db_cluster_snapshot",
          "aws_workspaces_ip_group",
          "aws_api_gateway_usage_plan",
          "aws_signer_signing_profile",
          "aws_organizations_policy",
          "aws_vpc_peering_connection",
          "aws_cognito_user_pool",
          "aws_codecommit_repository",
          "aws_inspector_assessment_template",
          "aws_db_event_subscription",
          "aws_codeartifact_domain",
          "aws_api_gateway_rest_api",
          "aws_lb_listener_rule",
          "aws_synthetics_canary",
          "aws_appconfig_application",
          "aws_dx_hosted_private_virtual_interface_accepter",
          "aws_s3control_bucket_lifecycle_configuration",
          "aws_docdb_cluster_instance",
          "aws_route_table",
          "aws_gamelift_build",
          "aws_db_instance",
          "aws_fsx_openzfs_snapshot",
          "aws_athena_workgroup",
          "aws_eip",
          "aws_config_configuration_aggregator",
          "aws_schemas_registry",
          "aws_vpc",
          "aws_iam_instance_profile",
          "aws_quicksight_data_source",
          "aws_vpc_endpoint",
          "aws_connect_quick_connect",
          "aws_sagemaker_app_image_config",
          "aws_xray_sampling_rule",
          "aws_ecr_repository",
          "aws_route53_resolver_rule",
          "aws_default_security_group",
          "aws_storagegateway_smb_file_share",
          "aws_opsworks_java_app_layer",
          "aws_codedeploy_deployment_group",
          "aws_sagemaker_image",
          "aws_apigatewayv2_vpc_link",
          "aws_appmesh_virtual_service",
          "aws_fsx_backup",
          "aws_emr_studio",
          "aws_datasync_task",
          "aws_rds_cluster_endpoint",
          "aws_route53recoveryreadiness_resource_set",
          "aws_dms_endpoint",
          "aws_waf_web_acl",
          "aws_eks_identity_provider_config",
          "aws_elastic_beanstalk_environment",
          "aws_detective_graph",
          "aws_ssm_parameter",
          "aws_cloudwatch_event_bus",
          "aws_cloud9_environment_ec2",
          "aws_cloudformation_stack",
          "aws_sagemaker_user_profile",
          "aws_kms_replica_key",
          "aws_secretsmanager_secret",
          "aws_devicefarm_project",
          "aws_ec2_local_gateway_route_table_vpc_association",
          "aws_neptune_event_subscription",
          "aws_s3_bucket_replication_configuration",
          "aws_codestarnotifications_notification_rule",
          "aws_appconfig_deployment_strategy",
          "aws_appmesh_gateway_route",
          "aws_dms_event_subscription",
          "aws_config_config_rule",
          "aws_datasync_location_smb",
          "aws_dx_connection",
          "aws_redshift_parameter_group",
          "aws_organizations_organizational_unit",
          "aws_lb_target_group",
          "aws_ebs_snapshot",
          "aws_iam_saml_provider",
          "aws_media_package_channel",
          "aws_api_gateway_client_certificate",
          "aws_guardduty_filter",
          "aws_appconfig_deployment",
          "aws_kms_replica_external_key",
          "aws_route53_resolver_query_log_config",
          "aws_datasync_location_fsx_lustre_file_system",
          "aws_workspaces_workspace",
          "aws_ssm_activation",
          "aws_iam_role",
          "aws_ecs_task_set",
          "aws_waf_rate_based_rule",
          "aws_dx_hosted_transit_virtual_interface_accepter",
          "aws_route53_health_check",
          "aws_apprunner_service",
          "aws_emr_cluster",
          "aws_cognito_identity_pool",
          "aws_elasticache_cluster",
          "aws_wafv2_ip_set",
          "aws_redshift_snapshot_schedule",
          "aws_network_acl",
          "aws_dx_lag",
          "aws_devicefarm_network_profile",
          "aws_kinesis_stream",
          "aws_ec2_transit_gateway",
          "aws_memorydb_snapshot",
          "aws_codestarconnections_connection",
          "aws_codebuild_report_group",
          "aws_route53recoveryreadiness_recovery_group",
          "aws_ec2_managed_prefix_list",
          "aws_route53_zone",
          "aws_instance",
          "aws_networkfirewall_rule_group",
          "aws_batch_compute_environment",
          "aws_devicefarm_device_pool",
          "aws_glue_schema",
          "aws_ecs_service",
          "aws_globalaccelerator_accelerator",
          "aws_memorydb_acl",
          "aws_docdb_cluster_parameter_group",
          "aws_ec2_transit_gateway_vpc_attachment_accepter",
          "aws_connect_contact_flow",
          "aws_shield_protection_group",
          "aws_opsworks_php_app_layer",
          "aws_lb",
          "aws_lambda_function",
          "aws_ec2_transit_gateway_peering_attachment",
          "aws_msk_cluster",
          "aws_sagemaker_app",
          "aws_glue_connection",
          "aws_apigatewayv2_api",
          "aws_key_pair",
          "aws_route53_resolver_firewall_rule_group_association",
          "aws_codebuild_project",
          "aws_eks_cluster",
          "aws_ec2_capacity_reservation",
          "aws_route53recoveryreadiness_readiness_check",
          "aws_sagemaker_endpoint_configuration",
          "aws_s3_bucket_object",
          "aws_ec2_transit_gateway_peering_attachment_accepter",
          "aws_vpc_peering_connection_accepter",
          "aws_timestreamwrite_database",
          "aws_ec2_traffic_mirror_target",
          "aws_transfer_server",
          "aws_datasync_location_efs",
          "aws_storagegateway_file_system_association",
          "aws_iot_thing_group",
          "aws_dax_cluster",
          "aws_schemas_schema",
          "aws_cloudwatch_event_rule",
          "aws_ssm_document",
          "aws_kms_external_key",
          "aws_glue_crawler",
          "aws_iot_thing_type",
          "aws_dms_replication_task",
          "aws_subnet",
          "aws_cloudformation_stack_set",
          "aws_licensemanager_license_configuration",
          "aws_dx_private_virtual_interface",
          "aws_guardduty_ipset",
          "aws_dms_replication_subnet_group",
          "aws_appmesh_mesh",
          "aws_lightsail_instance",
          "aws_acm_certificate",
          "aws_ec2_traffic_mirror_session",
          "aws_ssoadmin_permission_set",
          "aws_spot_fleet_request",
          "aws_cloudwatch_metric_stream",
          "aws_waf_rule_group",
          "aws_ec2_transit_gateway_vpc_attachment",
          "aws_efs_file_system",
          "aws_iot_topic_rule",
          "aws_qldb_ledger",
          "aws_rds_cluster_instance",
          "aws_efs_access_point",
          "aws_iam_server_certificate",
          "aws_default_vpc",
          "aws_eks_node_group",
          "aws_sfn_activity",
          "aws_ebs_volume",
          "aws_api_gateway_vpc_link",
          "aws_elasticache_replication_group",
          "aws_sagemaker_flow_definition",
          "aws_s3_bucket",
          "aws_opsworks_static_web_layer",
          "aws_customer_gateway",
          "aws_opsworks_rails_app_layer",
          "aws_glacier_vault",
          "aws_flow_log",
          "aws_nat_gateway",
          "aws_wafv2_web_acl",
          "aws_workspaces_directory",
          "aws_opsworks_nodejs_app_layer",
          "aws_macie2_classification_job",
          "aws_gamelift_fleet",
          "aws_glue_job",
          "aws_macie2_member",
          "aws_s3_object_copy",
          "aws_docdb_subnet_group",
          "aws_ec2_client_vpn_endpoint",
          "aws_backup_plan",
          "aws_autoscaling_group",
          "aws_s3_bucket_intelligent_tiering_configuration",
          "aws_eks_fargate_profile",
          "aws_rds_cluster_parameter_group",
          "aws_memorydb_subnet_group",
          "aws_datasync_agent",
          "aws_cloudtrail",
          "aws_memorydb_user",
          "aws_eks_addon",
          "aws_kinesis_video_stream",
          "aws_accessanalyzer_analyzer",
          "aws_neptune_cluster_parameter_group",
          "aws_security_group",
          "aws_fsx_openzfs_file_system",
          "aws_neptune_cluster_instance",
          "aws_sqs_queue",
          "aws_kinesisanalyticsv2_application",
          "aws_storagegateway_gateway",
          "aws_serverlessapplicationrepository_cloudformation_stack",
          "aws_ecs_cluster",
          "aws_macie2_findings_filter",
          "aws_route53_resolver_endpoint",
          "aws_db_subnet_group",
          "aws_media_convert_queue",
          "aws_ebs_snapshot_import",
          "aws_ami_copy",
          "aws_schemas_discoverer",
          "aws_sagemaker_human_task_ui",
          "aws_backup_vault",
          "aws_memorydb_parameter_group",
          "aws_fsx_lustre_file_system",
          "aws_route53_resolver_firewall_rule_group",
          "aws_cloudwatch_log_group",
          "aws_devicefarm_instance_profile",
          "aws_apprunner_connection",
          "aws_acmpca_certificate_authority",
          "aws_ec2_fleet",
          "aws_servicecatalog_provisioned_product",
          "aws_iam_openid_connect_provider",
          "aws_fsx_ontap_storage_virtual_machine",
          "aws_sagemaker_model_package_group",
          "aws_sagemaker_code_repository",
          "aws_fsx_openzfs_volume",
          "aws_sagemaker_domain",
          "aws_db_proxy",
          "aws_resourcegroups_group",
          "aws_directory_service_directory",
          "aws_imagebuilder_image_pipeline",
          "aws_default_vpc_dhcp_options",
          "aws_launch_template",
          "aws_mq_configuration",
          "aws_appstream_image_builder",
          "aws_media_store_container",
          "aws_apprunner_auto_scaling_configuration_version",
          "aws_ec2_traffic_mirror_filter",
          "aws_neptune_subnet_group",
          "aws_appconfig_configuration_profile",
          "aws_mwaa_environment",
          "aws_route53recoveryreadiness_cell",
          "aws_cloudhsm_v2_cluster",
          "aws_db_proxy_endpoint",
          "aws_batch_job_definition",
          "aws_swf_domain",
          "aws_opsworks_ganglia_layer",
          "aws_appmesh_virtual_node",
          "aws_wafregional_rule",
          "aws_sagemaker_notebook_instance",
          "aws_ram_resource_share",
          "aws_neptune_cluster",
          "aws_vpc_endpoint_service",
          "aws_ecs_task_definition",
          "aws_pinpoint_app",
          "aws_vpc_dhcp_options",
          "aws_xray_group",
          "aws_opsworks_stack",
          "aws_glue_workflow",
          "aws_fsx_windows_file_system",
          "aws_storagegateway_nfs_file_share",
          "aws_route53_resolver_firewall_domain_list",
          "aws_wafregional_rule_group",
          "aws_macie2_custom_data_identifier",
          "aws_imagebuilder_component",
          "aws_servicecatalog_product",
          "aws_appmesh_virtual_gateway",
          "aws_servicecatalog_portfolio",
          "aws_glue_ml_transform",
          "aws_lb_listener",
          "aws_ecs_capacity_provider",
          "aws_opsworks_memcached_layer",
          "aws_wafregional_rate_based_rule",
          "aws_ec2_carrier_gateway",
          "aws_db_parameter_group",
          "aws_internet_gateway",
          "aws_dx_transit_virtual_interface",
          "aws_appmesh_virtual_router",
          "aws_ebs_snapshot_copy",
          "aws_cloudwatch_metric_alarm",
          "aws_cloudwatch_event_target",
          "aws_connect_hours_of_operation",
          "aws_opsworks_haproxy_layer",
          "aws_imagebuilder_image",
          "aws_elastic_beanstalk_application_version",
          "aws_neptune_parameter_group",
          "aws_glue_trigger",
          "aws_db_snapshot",
          "aws_codeartifact_repository",
          "aws_opsworks_mysql_layer",
          "aws_mq_broker",
          "aws_redshift_event_subscription",
          "aws_spot_instance_request",
          "aws_api_gateway_stage",
          "aws_dms_replication_instance",
          "aws_egress_only_internet_gateway",
          "aws_appstream_fleet",
          "aws_sagemaker_feature_group",
          "aws_networkfirewall_firewall",
          "aws_imagebuilder_distribution_configuration",
          "aws_dynamodb_table",
          "aws_dlm_lifecycle_policy",
          "aws_guardduty_detector",
          "aws_sns_topic",
          "aws_placement_group"
        ],
        "severity": "Medium",
        "matchSpec": {
          "action": "and",
          "predicateMatchSpec": [
            {
              "name": "tags",
              "action": "contains",
              "value": "CreatedBy"
            },
            {
              "name": "tags",
              "action": "contains",
              "value": "Environment"
            },
            {
              "name": "tags",
              "action": "contains",
              "value": "Project"
            }
          ]
        },
        "errorMessage": "Following tags are required: 'CreatedBy', 'Environment', 'Project'",
        "relatedLinks": []
      }
    ]   
  }
  